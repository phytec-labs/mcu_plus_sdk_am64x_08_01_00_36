<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: IPC RPMessage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">08.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('DRIVERS_IPC_RPMESSAGE_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">IPC RPMessage </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md499">Features Supported</a></li>
<li class="level1"><a href="#autotoc_md500">SysConfig Features</a></li>
<li class="level1"><a href="#autotoc_md501">Features NOT Supported</a></li>
<li class="level1"><a href="#autotoc_md502">Important Usage Guidelines</a></li>
<li class="level1"><a href="#autotoc_md503">Example Usage</a></li>
<li class="level1"><a href="#autotoc_md504">API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_drivers_ipc_rpmsg"></a></p>
<dl class="section note"><dt>Note</dt><dd>These APIs are to be used from NORTOS/RTOS. When working with Linux on A53 refer to Linux documentation for Linux side APIs.</dd></dl>
<h1><a class="anchor" id="autotoc_md499"></a>
Features Supported</h1>
<ul>
<li>RP Message + VRING protocol implementation</li>
<li>Uses <a class="el" href="DRIVERS_IPC_NOTIFY_PAGE.html">IPC Notify</a> underneath for interrupts and uses shared memory (VRING) for message buffers</li>
<li>Supports message passing between NORTOS, FreeRTOS and Linux based CPUs</li>
<li>Logical communication channels can be created using unique "end points". This allows multiple tasks on a CPU to talk to multiple tasks on another CPU using the same underlying HW mailbox and shared memory.</li>
<li>Between NORTOS and RTOS, below can be configured in RP Message to control the shared memory size,<ul>
<li>Max message size, default is 128 bytes</li>
<li>Number of buffers in a VRING, default is 8 messages</li>
<li>VRING shared memory buffer address can be configured, can be DDR or internal memory address.</li>
</ul>
</li>
<li>Between Linux and NORTOS/RTOS, the VRING parameters are fixed as below<ul>
<li>Max message is 512B</li>
<li>NUmber of messages in a VRING is 256</li>
<li>VRING shared memory address is determined by value in Linux device tree and is placed in DDR.</li>
</ul>
</li>
<li>APIs to send and receive messages to user specified end points</li>
<li>Blocking, as well as non-blocking APIs with time out based blocking.</li>
<li>APIs to announce a created end point, needed when talking to Linux</li>
<li>API to sync and wait for LInux to be ready, needed when talking to Linux</li>
<li>APIs to use callback to receive message notifications instead of blocking, see <a class="el" href="structRPMessage__CreateParams.html">RPMessage_CreateParams</a> for more details.</li>
<li>APIs to use callback to receive and handle messages in callback itself, see <a class="el" href="structRPMessage__CreateParams.html">RPMessage_CreateParams</a> for more details.</li>
<li>Logging to Linux shared memory when IPC with Linux is enabled. Allows to view logs from RTOS/NORTOS on Linux using Linux debugfs.</li>
</ul>
<h1><a class="anchor" id="autotoc_md500"></a>
SysConfig Features</h1>
<dl class="section note"><dt>Note</dt><dd>It is strongly recommend to use SysConfig where it is available instead of using direct SW API calls. This will help simplify the SW application and also catch common mistakes early in the development cycle.</dd></dl>
<ul>
<li>Enable/Disable IPC RPMessage between different CPUs</li>
<li>Enable IPC RPMessage between NORTOS/RTOS and Linux. When enabled, SysConfig generates the resource table that is needed to talk with Linux.</li>
<li>Select RP Message max message size, number of buffer in a VRING</li>
</ul>
<h1><a class="anchor" id="autotoc_md501"></a>
Features NOT Supported</h1>
<p>NA</p>
<h1><a class="anchor" id="autotoc_md502"></a>
Important Usage Guidelines</h1>
<dl class="section note"><dt>Note</dt><dd>It is strongly recommended to refer to the IPC examples <code>examples/drivers/ipc</code> to understand the linker command file setup for IPC applications.</dd></dl>
<ul>
<li>When Linux runs along side RTOS/NORTOS, do below to make sure NORTOS/RTOS can talk to Linux.<ul>
<li>Make sure to call <a class="el" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga6a1f6307291e52b3221887ef299fd9e8" title="Wait for linux side RPMessage to be ready.">RPMessage_waitForLinuxReady()</a> before starting communication with Linux.</li>
<li>Also for any RPMessage point created on NORTOS/RTOS, make sure to announce it to Linux using <a class="el" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga765b5dc385428277e0f0ce8f374e5f47" title="Announce a local end point at which a service is created to a remote core.">RPMessage_announce()</a></li>
<li>Make sure to assign the shared memory used for VRING between Linux and this CPU as mentioned in the Linux device tree. Also make sure to mark this section as non-cached</li>
<li>If the CPU code will run out of DDR, make sure to setup a MPU entry for the code/data section in DDR. This can be marked as cached.</li>
<li>Again refer to Linux device tree to find out the space in DDR and MSMC where the NORTOS/RTOS applications can execute from.</li>
</ul>
</li>
<li>Make sure to assign the shared memory used for VRINGs between NORTOS/RTOS in a common memory section in each CPUs linker command file and make sure to mark this section as non-cached in the R5F MPU.</li>
<li>Maximum Message size is limited to 1152 Bytes in Syscfg and the maximum number of buffers is limited to 16. The recommended approach is to keep the number of buffers and message size within this limit.</li>
<li>If larger messages need to be passed, the data should be kept in a shared memory and a pointer to the same should be passed via IPC.</li>
</ul>
<h1><a class="anchor" id="autotoc_md503"></a>
Example Usage</h1>
<p>Include the below files to access the APIs </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ipc__rpmsg_8h.html">drivers/ipc_rpmsg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="DebugP_8h.html">kernel/dpl/DebugP.h</a>&gt;</span></div>
</div><!-- fragment --><p> Setup VRING shared memory for IPC RPMessage, this snippet is for reference and is generated by SysConfig when SysConfig is used for IPC. </p><div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">/* Below code is for reference, recommened to use SysCfg to generate this code */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Below is common code for all the CPUs participating in this IPC */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define NUM_CPUS            (2u) </span><span class="comment">/* R5FSS0-0 and R5FSS0-1 in this example */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define VRING_NUM           (NUM_CPUS*(NUM_CPUS-1))</span></div>
<div class="line"><span class="preprocessor">#define VRING_NUM_BUF       (8u)</span></div>
<div class="line"><span class="preprocessor">#define VRING_MAX_MSG_SIZE  (128u)   </span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Size of each VRING is</span></div>
<div class="line"><span class="comment"> *     number of buffers x ( size of each buffer + space for data structures of one buffer (32B) ) </span></div>
<div class="line"><span class="comment"> */</span> </div>
<div class="line"><span class="preprocessor">#define VRING_SIZE          RPMESSAGE_VRING_SIZE(VRING_NUM_BUF, VRING_MAX_MSG_SIZE) </span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Make sure of below,  </span></div>
<div class="line"><span class="comment"> * - The section defined below should be placed at the exact same location in memory for all the CPUs</span></div>
<div class="line"><span class="comment"> * - the memory should be marked as non-cached for all the CPUs</span></div>
<div class="line"><span class="comment"> * - the section should be marked as NOLOAD in all the CPUs linker command file</span></div>
<div class="line"><span class="comment"> */</span> </div>
<div class="line">uint8_t gVringMem[VRING_NUM][VRING_SIZE] <a class="code" href="group__tisci__boardcfg.html#gae9a5e6ddd546ab114631297cdb6a0874">__attribute__</a>((aligned(128), section(<span class="stringliteral">&quot;.bss.sharedmemory&quot;</span>)));</div>
<div class="line"> </div>
</div><!-- fragment --><p> Initialize IPC RPMessage, this snippet is for reference and is generated by SysConfig when SysConfig is used for IPC. </p><div class="fragment"><div class="line"><span class="comment">/* Below code is for reference, recommened to use SysCfg to generate this code */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment">     * - Below code is for Core 0</span></div>
<div class="line"><span class="comment">     * - Make sure IPC Notify is enabled before enabling IPC RPMessage</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    int32_t status;</div>
<div class="line">    <a class="code" href="structRPMessage__Params.html">RPMessage_Params</a> initParams;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga353a4139549fa6733571cc3189b658bd">RPMessage_Params_init</a>(&amp;initParams);</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#acac88d90d3adaf0ab45a7ce95882eb19">vringTxBaseAddr</a>[<a class="code" href="cslr__soc__defines_8h.html#a2a5b4840c743a891534e4d7f6d2699f3">CSL_CORE_ID_R5FSS0_1</a>] = (uintptr_t)gVringMem[0];</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#a2aa1c041d778c80b5db9c5d854f105cc">vringRxBaseAddr</a>[<a class="code" href="cslr__soc__defines_8h.html#a2a5b4840c743a891534e4d7f6d2699f3">CSL_CORE_ID_R5FSS0_1</a>] = (uintptr_t)gVringMem[1];</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#aa59be9cdd57fe409346ba910ed2d8736">vringNumBuf</a> = VRING_NUM_BUF;</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#a2323a73d6a7ea3476b8f0a54db22a0b4">vringMsgSize</a> = VRING_MAX_MSG_SIZE;</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#af894aa745563cde9181059e3a11d773c">vringSize</a> = VRING_SIZE;</div>
<div class="line">    status = <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga11518ab5595c5ac2d1233e946fa89536">RPMessage_init</a>(&amp;initParams);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(status==<a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a>);</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/* Below code is for reference, recommened to use SysCfg to generate this code */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment">     * - Below code is for Core 1</span></div>
<div class="line"><span class="comment">     * - Make sure IPC Notify is enabled before enabling IPC RPMessage</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    int32_t status;</div>
<div class="line">    <a class="code" href="structRPMessage__Params.html">RPMessage_Params</a> initParams;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga353a4139549fa6733571cc3189b658bd">RPMessage_Params_init</a>(&amp;initParams);</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#acac88d90d3adaf0ab45a7ce95882eb19">vringTxBaseAddr</a>[<a class="code" href="cslr__soc__defines_8h.html#a822173b770be26a93c3bec07938fe6d8">CSL_CORE_ID_R5FSS0_0</a>] = (uintptr_t)gVringMem[1];</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#a2aa1c041d778c80b5db9c5d854f105cc">vringRxBaseAddr</a>[<a class="code" href="cslr__soc__defines_8h.html#a822173b770be26a93c3bec07938fe6d8">CSL_CORE_ID_R5FSS0_0</a>] = (uintptr_t)gVringMem[0];</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#aa59be9cdd57fe409346ba910ed2d8736">vringNumBuf</a> = VRING_NUM_BUF;</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#a2323a73d6a7ea3476b8f0a54db22a0b4">vringMsgSize</a> = VRING_MAX_MSG_SIZE;</div>
<div class="line">    initParams.<a class="code" href="structRPMessage__Params.html#af894aa745563cde9181059e3a11d773c">vringSize</a> = VRING_SIZE;</div>
<div class="line">    status = <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga11518ab5595c5ac2d1233e946fa89536">RPMessage_init</a>(&amp;initParams);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(status==<a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a>);</div>
</div><!-- fragment --><p> Define <a class="el" href="structRPMessage__Object.html">RPMessage_Object</a> objects for receive and ack endpoints, </p><div class="fragment"><div class="line"><span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment"> * - Below code is for Core 0</span></div>
<div class="line"><span class="comment"> * - All RPMessage_Object MUST be global </span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a class="code" href="structRPMessage__Object.html">RPMessage_Object</a> gAckReplyMsgObject;</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment"> * - Below code is for Core 1</span></div>
<div class="line"><span class="comment"> * - All RPMessage_Object MUST be global </span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a class="code" href="structRPMessage__Object.html">RPMessage_Object</a> gRecvMsgObject;</div>
</div><!-- fragment --><p> Create RPMessage end points for receive and ack endpoints, </p><div class="fragment"><div class="line">    <span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment">     * - Below code is for Core 0</span></div>
<div class="line"><span class="comment">     */</span> </div>
<div class="line">    <a class="code" href="structRPMessage__CreateParams.html">RPMessage_CreateParams</a> createParams;</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga243ad0c7f5653e91410566c5d548d6f1">RPMessage_CreateParams_init</a>(&amp;createParams);</div>
<div class="line">    createParams.<a class="code" href="structRPMessage__CreateParams.html#ad4e5fe99c906858d45338d428ececf93">localEndPt</a> = 12; <span class="comment">/* pick any unique value on that core between 0..RPMESSAGE_MAX_LOCAL_ENDPT-1 </span></div>
<div class="line"><span class="comment">                                   * the value need not be unique across cores </span></div>
<div class="line"><span class="comment">                                   */</span></div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga3f4755622a1a85b816b156f11ab126e3">RPMessage_construct</a>(&amp;gAckReplyMsgObject, &amp;createParams);</div>
</div><!-- fragment --><div class="fragment"><div class="line">    <span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment">     * - Below code is for Core 1</span></div>
<div class="line"><span class="comment">     */</span> </div>
<div class="line">    <a class="code" href="structRPMessage__CreateParams.html">RPMessage_CreateParams</a> createParams;</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga243ad0c7f5653e91410566c5d548d6f1">RPMessage_CreateParams_init</a>(&amp;createParams);</div>
<div class="line">    createParams.<a class="code" href="structRPMessage__CreateParams.html#ad4e5fe99c906858d45338d428ececf93">localEndPt</a> = 13; <span class="comment">/* pick any unique value on that core between 0..RPMESSAGE_MAX_LOCAL_ENDPT-1 </span></div>
<div class="line"><span class="comment">                                   * the value need not be unique across cores </span></div>
<div class="line"><span class="comment">                                   */</span></div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga3f4755622a1a85b816b156f11ab126e3">RPMessage_construct</a>(&amp;gRecvMsgObject, &amp;createParams);</div>
</div><!-- fragment --><p> Send message from Core 0 to Core 1 and wait for reply from Core 1, </p><div class="fragment"><div class="line">    <span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment">     * - Below code is for Core 0</span></div>
<div class="line"><span class="comment">     */</span> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span> sendMsg[64] = <span class="stringliteral">&quot;hello, world!!!&quot;</span>;</div>
<div class="line">    <span class="keywordtype">char</span> replyMsg[64];</div>
<div class="line">    uint16_t replyMsgSize, remoteCoreId, remoteCoreEndPt;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#gaa1b08e6316921caa469982a34c06841b">RPMessage_send</a>( </div>
<div class="line">        sendMsg, strlen(sendMsg), </div>
<div class="line">        <a class="code" href="cslr__soc__defines_8h.html#a2a5b4840c743a891534e4d7f6d2699f3">CSL_CORE_ID_R5FSS0_1</a>, 13, </div>
<div class="line">        <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga3f5a806cd00de417cf067f324e221ef8">RPMessage_getLocalEndPt</a>(&amp;gAckReplyMsgObject),</div>
<div class="line">        <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga376db5d2fbbc54611736778be8e15431">SystemP_WAIT_FOREVER</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* set &#39;replyMsgSize&#39; to size of recv buffer, </span></div>
<div class="line"><span class="comment">     * after return `replyMsgSize` contains actual size of valid data in recv buffer </span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    replyMsgSize = <span class="keyword">sizeof</span>(replyMsg); <span class="comment">/*  */</span></div>
<div class="line">    <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#gaff81ed42f1cbf0d5118bafef6a0b7add">RPMessage_recv</a>(&amp;gAckReplyMsgObject, </div>
<div class="line">        replyMsg, &amp;replyMsgSize, </div>
<div class="line">        &amp;remoteCoreId, &amp;remoteCoreEndPt, </div>
<div class="line">        <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga376db5d2fbbc54611736778be8e15431">SystemP_WAIT_FOREVER</a>);</div>
</div><!-- fragment --><p> Receive message at Core 1 from Core 0 and send ack to Core 0, </p><div class="fragment"><div class="line">    <span class="comment">/* IMPORTANT: </span></div>
<div class="line"><span class="comment">     * - Below code is for Core 1</span></div>
<div class="line"><span class="comment">     */</span> </div>
<div class="line">    <span class="keywordflow">while</span>(1)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">char</span> recvMsg[64];</div>
<div class="line">        <span class="keywordtype">char</span> replyMsg[64];</div>
<div class="line">        uint16_t recvMsgSize, remoteCoreId, remoteCoreEndPt;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* wait for messages forever in a loop */</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* set &#39;recvMsgSize&#39; to size of recv buffer, </span></div>
<div class="line"><span class="comment">        * after return `recvMsgSize` contains actual size of valid data in recv buffer </span></div>
<div class="line"><span class="comment">        */</span></div>
<div class="line">        recvMsgSize = <span class="keyword">sizeof</span>(recvMsg);</div>
<div class="line">        <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#gaff81ed42f1cbf0d5118bafef6a0b7add">RPMessage_recv</a>(&amp;gRecvMsgObject, </div>
<div class="line">            recvMsg, &amp;recvMsgSize, </div>
<div class="line">            &amp;remoteCoreId, &amp;remoteCoreEndPt, </div>
<div class="line">            <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga376db5d2fbbc54611736778be8e15431">SystemP_WAIT_FOREVER</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* echo the message string as reply, we know this is null terminating string</span></div>
<div class="line"><span class="comment">         * so strcpy is safe to use.</span></div>
<div class="line"><span class="comment">         */</span></div>
<div class="line">        strcpy(replyMsg, recvMsg);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* send ack to sender CPU at the sender end point */</span></div>
<div class="line">        <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#gaa1b08e6316921caa469982a34c06841b">RPMessage_send</a>( </div>
<div class="line">            replyMsg, strlen(replyMsg), </div>
<div class="line">            remoteCoreId, remoteCoreEndPt, </div>
<div class="line">            <a class="code" href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga3f5a806cd00de417cf067f324e221ef8">RPMessage_getLocalEndPt</a>(&amp;gRecvMsgObject),</div>
<div class="line">            <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga376db5d2fbbc54611736778be8e15431">SystemP_WAIT_FOREVER</a>);</div>
<div class="line">    }</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md504"></a>
API</h1>
<p><a class="el" href="group__DRV__IPC__RPMESSAGE__MODULE.html">APIs for IPC RPMessage</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__DRV__IPC__RPMESSAGE__MODULE_html_gaff81ed42f1cbf0d5118bafef6a0b7add"><div class="ttname"><a href="group__DRV__IPC__RPMESSAGE__MODULE.html#gaff81ed42f1cbf0d5118bafef6a0b7add">RPMessage_recv</a></div><div class="ttdeci">int32_t RPMessage_recv(RPMessage_Object *obj, void *data, uint16_t *dataLen, uint16_t *remoteCoreId, uint16_t *remoteEndPt, uint32_t timeout)</div><div class="ttdoc">Blocking API to wait till a message is received from any CPU at the specified local end point.</div></div>
<div class="ttc" id="astructRPMessage__Params_html_acac88d90d3adaf0ab45a7ce95882eb19"><div class="ttname"><a href="structRPMessage__Params.html#acac88d90d3adaf0ab45a7ce95882eb19">RPMessage_Params::vringTxBaseAddr</a></div><div class="ttdeci">uintptr_t vringTxBaseAddr[CSL_CORE_ID_MAX]</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:185</div></div>
<div class="ttc" id="astructRPMessage__Object_html"><div class="ttname"><a href="structRPMessage__Object.html">RPMessage_Object</a></div><div class="ttdoc">Opaque RPMessage object used with the RPMessage APIs.</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:94</div></div>
<div class="ttc" id="astructRPMessage__Params_html_af894aa745563cde9181059e3a11d773c"><div class="ttname"><a href="structRPMessage__Params.html#af894aa745563cde9181059e3a11d773c">RPMessage_Params::vringSize</a></div><div class="ttdeci">uint32_t vringSize</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:187</div></div>
<div class="ttc" id="astructRPMessage__CreateParams_html_ad4e5fe99c906858d45338d428ececf93"><div class="ttname"><a href="structRPMessage__CreateParams.html#ad4e5fe99c906858d45338d428ececf93">RPMessage_CreateParams::localEndPt</a></div><div class="ttdeci">uint16_t localEndPt</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:166</div></div>
<div class="ttc" id="agroup__DRV__IPC__RPMESSAGE__MODULE_html_ga3f4755622a1a85b816b156f11ab126e3"><div class="ttname"><a href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga3f4755622a1a85b816b156f11ab126e3">RPMessage_construct</a></div><div class="ttdeci">int32_t RPMessage_construct(RPMessage_Object *obj, const RPMessage_CreateParams *createParams)</div><div class="ttdoc">Create a RPMessage object to receive messages at a specified end-point.</div></div>
<div class="ttc" id="acslr__soc__defines_8h_html_a822173b770be26a93c3bec07938fe6d8"><div class="ttname"><a href="cslr__soc__defines_8h.html#a822173b770be26a93c3bec07938fe6d8">CSL_CORE_ID_R5FSS0_0</a></div><div class="ttdeci">#define CSL_CORE_ID_R5FSS0_0</div><div class="ttdef"><b>Definition:</b> cslr_soc_defines.h:69</div></div>
<div class="ttc" id="astructRPMessage__Params_html_a2323a73d6a7ea3476b8f0a54db22a0b4"><div class="ttname"><a href="structRPMessage__Params.html#a2323a73d6a7ea3476b8f0a54db22a0b4">RPMessage_Params::vringMsgSize</a></div><div class="ttdeci">uint16_t vringMsgSize</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:189</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__SYSTEM_html_ga376db5d2fbbc54611736778be8e15431"><div class="ttname"><a href="group__KERNEL__DPL__SYSTEM.html#ga376db5d2fbbc54611736778be8e15431">SystemP_WAIT_FOREVER</a></div><div class="ttdeci">#define SystemP_WAIT_FOREVER</div><div class="ttdoc">Value to use when needing a timeout of infinity or wait forver until resource is available.</div><div class="ttdef"><b>Definition:</b> SystemP.h:83</div></div>
<div class="ttc" id="agroup__DRV__IPC__RPMESSAGE__MODULE_html_ga11518ab5595c5ac2d1233e946fa89536"><div class="ttname"><a href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga11518ab5595c5ac2d1233e946fa89536">RPMessage_init</a></div><div class="ttdeci">int32_t RPMessage_init(const RPMessage_Params *params)</div><div class="ttdoc">Initialize RPMessage module.</div></div>
<div class="ttc" id="agroup__DRV__IPC__RPMESSAGE__MODULE_html_ga3f5a806cd00de417cf067f324e221ef8"><div class="ttname"><a href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga3f5a806cd00de417cf067f324e221ef8">RPMessage_getLocalEndPt</a></div><div class="ttdeci">uint16_t RPMessage_getLocalEndPt(const RPMessage_Object *obj)</div><div class="ttdoc">Return local end point of a RPMessage_Object.</div></div>
<div class="ttc" id="agroup__DRV__IPC__RPMESSAGE__MODULE_html_ga353a4139549fa6733571cc3189b658bd"><div class="ttname"><a href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga353a4139549fa6733571cc3189b658bd">RPMessage_Params_init</a></div><div class="ttdeci">void RPMessage_Params_init(RPMessage_Params *params)</div><div class="ttdoc">Set default values to RPMessage_Params.</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__SYSTEM_html_ga47e638d7c694e6d42e57b96b071b8a6f"><div class="ttname"><a href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a></div><div class="ttdeci">#define SystemP_SUCCESS</div><div class="ttdoc">Return status when the API execution was successful.</div><div class="ttdef"><b>Definition:</b> SystemP.h:56</div></div>
<div class="ttc" id="agroup__DRV__IPC__RPMESSAGE__MODULE_html_ga243ad0c7f5653e91410566c5d548d6f1"><div class="ttname"><a href="group__DRV__IPC__RPMESSAGE__MODULE.html#ga243ad0c7f5653e91410566c5d548d6f1">RPMessage_CreateParams_init</a></div><div class="ttdeci">void RPMessage_CreateParams_init(RPMessage_CreateParams *params)</div><div class="ttdoc">Set default values to RPMessage_CreateParams.</div></div>
<div class="ttc" id="agroup__tisci__boardcfg_html_gae9a5e6ddd546ab114631297cdb6a0874"><div class="ttname"><a href="group__tisci__boardcfg.html#gae9a5e6ddd546ab114631297cdb6a0874">__attribute__</a></div><div class="ttdeci">struct tisci_boardcfg_sa2ul_cfg __attribute__</div></div>
<div class="ttc" id="astructRPMessage__Params_html_a2aa1c041d778c80b5db9c5d854f105cc"><div class="ttname"><a href="structRPMessage__Params.html#a2aa1c041d778c80b5db9c5d854f105cc">RPMessage_Params::vringRxBaseAddr</a></div><div class="ttdeci">uintptr_t vringRxBaseAddr[CSL_CORE_ID_MAX]</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:186</div></div>
<div class="ttc" id="aDebugP_8h_html"><div class="ttname"><a href="DebugP_8h.html">DebugP.h</a></div></div>
<div class="ttc" id="astructRPMessage__Params_html_aa59be9cdd57fe409346ba910ed2d8736"><div class="ttname"><a href="structRPMessage__Params.html#aa59be9cdd57fe409346ba910ed2d8736">RPMessage_Params::vringNumBuf</a></div><div class="ttdeci">uint16_t vringNumBuf</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:188</div></div>
<div class="ttc" id="astructRPMessage__Params_html"><div class="ttname"><a href="structRPMessage__Params.html">RPMessage_Params</a></div><div class="ttdoc">Parameters passed to RPMessage_init, these are generated via SysCfg.</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:184</div></div>
<div class="ttc" id="acslr__soc__defines_8h_html_a2a5b4840c743a891534e4d7f6d2699f3"><div class="ttname"><a href="cslr__soc__defines_8h.html#a2a5b4840c743a891534e4d7f6d2699f3">CSL_CORE_ID_R5FSS0_1</a></div><div class="ttdeci">#define CSL_CORE_ID_R5FSS0_1</div><div class="ttdef"><b>Definition:</b> cslr_soc_defines.h:70</div></div>
<div class="ttc" id="aipc__rpmsg_8h_html"><div class="ttname"><a href="ipc__rpmsg_8h.html">ipc_rpmsg.h</a></div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_ga552e9055ca7eab5fe6c224c6cd5a9d4c"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a></div><div class="ttdeci">#define DebugP_assert(expression)</div><div class="ttdoc">Function to call for assert check.</div><div class="ttdef"><b>Definition:</b> DebugP.h:159</div></div>
<div class="ttc" id="astructRPMessage__CreateParams_html"><div class="ttname"><a href="structRPMessage__CreateParams.html">RPMessage_CreateParams</a></div><div class="ttdoc">Parameters passed to RPMessage_construct.</div><div class="ttdef"><b>Definition:</b> ipc_rpmsg.h:165</div></div>
<div class="ttc" id="agroup__DRV__IPC__RPMESSAGE__MODULE_html_gaa1b08e6316921caa469982a34c06841b"><div class="ttname"><a href="group__DRV__IPC__RPMESSAGE__MODULE.html#gaa1b08e6316921caa469982a34c06841b">RPMessage_send</a></div><div class="ttdeci">int32_t RPMessage_send(void *data, uint16_t dataLen, uint16_t remoteCoreId, uint16_t remoteEndPt, uint16_t localEndPt, uint32_t timeout)</div><div class="ttdoc">Send a message to a remote core at a specified remote end point.</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
