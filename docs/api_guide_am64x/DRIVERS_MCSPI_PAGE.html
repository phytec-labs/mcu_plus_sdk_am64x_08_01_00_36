<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: MCSPI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">08.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('DRIVERS_MCSPI_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">MCSPI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md524">Features Supported</a></li>
<li class="level1"><a href="#autotoc_md525">SysConfig Features</a></li>
<li class="level1"><a href="#autotoc_md526">Features NOT Supported</a></li>
<li class="level1"><a href="#autotoc_md527">Usage Overview</a><ul><li class="level2"><a href="#autotoc_md528">API Sequence</a></li>
<li class="level2"><a href="#autotoc_md529">Initializing the MCSPI Driver</a></li>
<li class="level2"><a href="#autotoc_md530">Opening the MCSPI Driver</a></li>
<li class="level2"><a href="#autotoc_md531">MCSPI Transfer Mode</a></li>
<li class="level2"><a href="#autotoc_md532">MCSPI Frame Formats and Data Size</a></li>
<li class="level2"><a href="#autotoc_md533">MCSPI Transactions</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md534">Important Usage Guidelines</a></li>
<li class="level1"><a href="#autotoc_md535">Example Usage</a></li>
<li class="level1"><a href="#autotoc_md536">API</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_components_drivers_mcspi"></a></p>
<p>The Multi Channel Serial Peripheral Interface (MCSPI) driver is a generic, full-duplex driver that transmits and receives data on the SPI bus. The SPI protocol defines the format of a data transfer over the SPI bus, but it leaves flow control, data formatting, and handshaking mechanisms to higher-level software layers.</p>
<h1><a class="anchor" id="autotoc_md524"></a>
Features Supported</h1>
<ul>
<li>Master and Slave mode of operation</li>
<li>Per transfer selection of different channels/chip select</li>
<li>Blocking and non-blocking (callback) transfers</li>
<li>For low latency transfers, refer <a class="el" href="EXAMPLES_DRIVERS_MCSPI_PERFORMANCE_32BIT.html">MCSPI Performance 32 Bit</a> and <a class="el" href="EXAMPLES_DRIVERS_MCSPI_PERFORMANCE_8BIT.html">MCSPI Performance 8 Bit</a> example. This example uses polling mode of operation.</li>
</ul>
<h1><a class="anchor" id="autotoc_md525"></a>
SysConfig Features</h1>
<dl class="section note"><dt>Note</dt><dd>It is strongly recommend to use SysConfig where it is available instead of using direct SW API calls. This will help simplify the SW application and also catch common mistakes early in the development cycle.</dd></dl>
<p>SysConfig can be used to configure below parameters apart from common configuration like Clock,MPU,RAT and others.</p><ul>
<li>MCSPI module configuration parameters like Transmit/Receive mode,MISO, MOSI pin selection and others.</li>
<li>MCSPI channel configurations.</li>
<li>In the advanced configurations option you can configure initial delay for first transfer, transfer mode and timeout.</li>
<li>MCSPI instances and pin configurations.</li>
<li>Interrupt mode enable option.If you disable it, configures to polling mode.</li>
<li>Based on above parameters, the SysConfig generated code does below as part of Drivers_open and Drivers_close functions<ul>
<li>Set MCSPI instance parameter configuration.</li>
<li>Driver ISR registration if Interrupt Mode is enabled.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md526"></a>
Features NOT Supported</h1>
<ul>
<li>DMA mode of operation</li>
</ul>
<h1><a class="anchor" id="autotoc_md527"></a>
Usage Overview</h1>
<h2><a class="anchor" id="autotoc_md528"></a>
API Sequence</h2>
<p>To use the MCSPI driver to send data over the SPI bus, the application calls the following APIs:</p>
<ul>
<li><a class="el" href="group__DRV__MCSPI__MODULE.html#ga7ab49f55fcfb89a487857e9a27ca7083" title="This function initializes the MCSPI module.">MCSPI_init()</a>: Initialize the MCSPI driver.</li>
<li><a class="el" href="group__DRV__MCSPI__MODULE.html#ga8e2f6ba4de2ec70859f37324e6aa65ba" title="Function to initialize the MCSPI_OpenParams struct to its defaults.">MCSPI_OpenParams_init()</a>: Initialize a <a class="el" href="structMCSPI__OpenParams.html" title="MCSPI Parameters.">MCSPI_OpenParams</a> structure with default values. Then change the parameters from non-default values as needed.</li>
<li><a class="el" href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923" title="This function opens a given MCSPI peripheral.">MCSPI_open()</a>: Open an instance of the MCSPI driver, passing the initialized parameters, or NULL, and an index to the configuration to open (detailed later).</li>
<li><a class="el" href="group__DRV__MCSPI__MODULE.html#gaf55bfd5fe8741647f107cacba32a04e3" title="Function to configure a MCSPI channel.">MCSPI_chConfig()</a>: Configure the required channels</li>
<li><a class="el" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9" title="Function to perform MCSPI transactions.">MCSPI_transfer()</a>: Transmit/receive data. This function takes a <a class="el" href="structMCSPI__Transaction.html" title="Data structure used with MCSPI_transfer()">MCSPI_Transaction</a> argument that describes the transfer that is requested.</li>
<li><a class="el" href="group__DRV__MCSPI__MODULE.html#ga12824149d7be9c07abd4cb120ec7cf13" title="Function to close a MCSPI peripheral specified by the MCSPI handle.">MCSPI_close()</a>: De-initialize the MCSPI instance.</li>
<li><a class="el" href="group__DRV__MCSPI__MODULE.html#gaf34ea4d022337821d4c7066505726893" title="This function de-initializes the MCSPI module.">MCSPI_deinit()</a>: De-Initialize the MCSPI driver.</li>
</ul>
<h2><a class="anchor" id="autotoc_md529"></a>
Initializing the MCSPI Driver</h2>
<p><a class="el" href="group__DRV__MCSPI__MODULE.html#ga7ab49f55fcfb89a487857e9a27ca7083" title="This function initializes the MCSPI module.">MCSPI_init()</a> must be called before any other MCSPI APIs. This function iterates through the elements of the MCSPI_config[] array, calling the element's device implementation MCSPI initialization function. Please note that initializing MCSPI driver is taken care by the SysConfig generated code.</p>
<h2><a class="anchor" id="autotoc_md530"></a>
Opening the MCSPI Driver</h2>
<p>After initializing the MCSPI driver by calling <a class="el" href="group__DRV__MCSPI__MODULE.html#ga7ab49f55fcfb89a487857e9a27ca7083" title="This function initializes the MCSPI module.">MCSPI_init()</a>, the application can open a MCSPI instance by calling <a class="el" href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923" title="This function opens a given MCSPI peripheral.">MCSPI_open()</a>. Please note that opening MCSPI driver is taken care by the SysConfig generated code. This function takes an index into the MCSPI_config[] array, and the MCSPI parameters data structure. The MCSPI instance is specified by the index of the SPI in MCSPI_config[]. Calling <a class="el" href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923" title="This function opens a given MCSPI peripheral.">MCSPI_open()</a> a second time with the same index previously passed to <a class="el" href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923" title="This function opens a given MCSPI peripheral.">MCSPI_open()</a> will result in an error. You can, though, re-use the index if the instance is closed via <a class="el" href="group__DRV__MCSPI__MODULE.html#ga12824149d7be9c07abd4cb120ec7cf13" title="Function to close a MCSPI peripheral specified by the MCSPI handle.">MCSPI_close()</a>.</p>
<p>If no <a class="el" href="structMCSPI__OpenParams.html" title="MCSPI Parameters.">MCSPI_OpenParams</a> structure is passed to <a class="el" href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923" title="This function opens a given MCSPI peripheral.">MCSPI_open()</a>, default values are used. If the open call is successful, it returns a non-NULL value.</p>
<h2><a class="anchor" id="autotoc_md531"></a>
MCSPI Transfer Mode</h2>
<p>The MCSPI driver supports two transfer modes of operation:Interrupt and Polling Mode. In interrupt mode it again supports two modes: blocking and callback. The transfer mode is determined by the <a class="el" href="structMCSPI__OpenParams.html#a0b4ecaba7263bd18bc7e40924d8d6c97">MCSPI_OpenParams.transferMode</a> parameter. The MCSPI driver defaults to blocking mode, if the application does not set it. Once a MCSPI driver is opened, the only way to change the operation mode is to close and re-open the MCSPI instance with the new transfer mode.</p>
<p>In blocking mode, a task's code execution is blocked until a MCSPI transaction has completed or a timeout has occurred. This ensures that only one MCSPI transfer operates at a given time. Other tasks requesting MCSPI transfers while a transfer is currently taking place will receive a error return value. If a timeout occurs the transfer is canceled, the task is unblocked &amp; will receive a error return value. The transaction count field will have the amount of frames which were transferred successfully before the timeout. In blocking mode, transfers cannot be performed in software or hardware ISR context.</p>
<p>In callback mode, a MCSPI transaction functions asynchronously, which means that it does not block code execution. After a MCSPI transaction has been completed, the MCSPI driver calls a user-provided hook function. Callback mode is supported in the execution context of tasks and hardware interrupt routines.</p>
<p>In multichannel mode connected to multiple external devices, the MCSPI exchanges data with one MCSPI device at a time and FIFO is enabled per each channel at a time.</p>
<h2><a class="anchor" id="autotoc_md532"></a>
MCSPI Frame Formats and Data Size</h2>
<p>The MCSPI driver can configure the device's MCSPI peripheral to transfer data in several MCSPI format options: MCSPI (with various polarity and phase settings). The frame format is set with <a class="el" href="structMCSPI__ChConfig.html#a4a6549cd630c209437341c9c518e02aa">MCSPI_ChConfig.frameFormat</a>.</p>
<p>The smallest single unit of data transmitted onto the MCSPI bus is called a MCSPI frame and is of size <a class="el" href="structMCSPI__ChConfig.html#a2b07488d7d440d8cb8c220de4ea398bd">MCSPI_ChConfig.dataSize</a>. A series of MCSPI frames transmitted/received on a MCSPI bus is referred to as a MCSPI transaction.</p>
<h2><a class="anchor" id="autotoc_md533"></a>
MCSPI Transactions</h2>
<p>A MCSPI transaction consists of a series of MCSPI frames transmitted/received on a MCSPI bus. A MCSPI transaction is performed using <a class="el" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9" title="Function to perform MCSPI transactions.">MCSPI_transfer()</a>. <a class="el" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9" title="Function to perform MCSPI transactions.">MCSPI_transfer()</a> accepts a pointer to a <a class="el" href="structMCSPI__Transaction.html" title="Data structure used with MCSPI_transfer()">MCSPI_Transaction</a> structure that dictates the quantity of data to be sent and received. The <a class="el" href="structMCSPI__Transaction.html#a1344bb4f68f64e6841a25884de818f7b">MCSPI_Transaction.txBuf</a> and <a class="el" href="structMCSPI__Transaction.html#a13379551362963f30946a9ef45d9efc9">MCSPI_Transaction.rxBuf</a> are both pointers to data buffers. If txBuf is NULL, the driver sends MCSPI frames with all data set to the default value specified in the hardware attributes. If rxBuf is NULL, the driver discards all MCSPI frames received. <a class="el" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9" title="Function to perform MCSPI transactions.">MCSPI_transfer()</a> of a MCSPI transaction is performed atomically.</p>
<dl class="section warning"><dt>Warning</dt><dd>The use of NULL as a sentinel txBuf or rxBuf value to determine whether the MCSPI transaction includes a tx or rx component implies that it is not possible to perform a transmit or receive transfer directly from/to a buffer with a base address of 0x00000000. To support this rare use-case, the application will have to manually copy the contents of location 0x00000000 to/from a temporary buffer before/after the tx/rx MCSPI transaction.</dd></dl>
<p>When the MCSPI is opened, the dataSize value determines the element types of txBuf and rxBuf. If the dataSize is from 4 to 8 bits, the driver assumes the data buffers are of type uint8_t (unsigned char). If the dataSize is from 9 to 16 bits, the driver assumes the data buffers are of type uint16_t (unsigned short). If the dataSize is greater than 16 bits, the driver assumes the data buffers are uint32_t (unsigned long).</p>
<p>The optional <a class="el" href="structMCSPI__Transaction.html#a7789f4810d4b1818b3cd2a1cdd4a01cd">MCSPI_Transaction.args</a> variable can only be used when the MCSPI driver has been opened in callback mode. This variable is used to pass a user-defined value into the user-defined callback function.</p>
<p><a class="el" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9" title="Function to perform MCSPI transactions.">MCSPI_transfer()</a> always performs full-duplex MCSPI transactions. This means the MCSPI simultaneously receives data as it transmits data. The application is responsible for formatting the data to be transmitted as well as determining whether the data received is meaningful. Specifics about MCSPI frame formatting and data sizes are provided in device-specific data sheets and technical reference manuals.</p>
<p>In case of MCSPI operating in <a class="el" href="group__DRV__MCSPI__MODULE.html#ga341e1ae08a352df52057b167dc602033" title="The module receives the clock and CS.">MCSPI_MS_MODE_SLAVE</a> mode if Rx overflow or Tx underflow occurs, driver cancels the current transfer and return status MCSPI_TRANSFER_CANCELLED to the application. Application need to check the status and reinitiate transfers again.</p>
<h1><a class="anchor" id="autotoc_md534"></a>
Important Usage Guidelines</h1>
<ul>
<li>The MCSPI protocol does not account for a built-in handshaking mechanism and neither does this driver. Therefore, when operating in <a class="el" href="group__DRV__MCSPI__MODULE.html#ga341e1ae08a352df52057b167dc602033" title="The module receives the clock and CS.">MCSPI_MS_MODE_SLAVE</a> mode, the application must provide such a mechanism to ensure that the MCSPI slave is ready for the MCSPI master. The MCSPI slave must call <a class="el" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9" title="Function to perform MCSPI transactions.">MCSPI_transfer()</a> <em>before</em> the master starts transmitting. Some example application mechanisms could include:<ul>
<li>Timed delays on the MCSPI master to guarantee the MCSPI slave is ready for a MCSPI transaction.</li>
<li>A form of GPIO flow control from the slave to the MCSPI master to notify the master when ready.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md535"></a>
Example Usage</h1>
<p>Include the below file to access the APIs </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="mcspi_8h.html">drivers/mcspi.h</a>&gt;</span></div>
</div><!-- fragment --><p> Instance Open Example </p><div class="fragment"><div class="line">    int32_t             status;</div>
<div class="line">    <a class="code" href="structMCSPI__OpenParams.html">MCSPI_OpenParams</a>    spiParams;</div>
<div class="line">    uint32_t            chCnt;</div>
<div class="line">    <a class="code" href="structMCSPI__ChConfig.html">MCSPI_ChConfig</a>     *chCfg;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__DRV__MCSPI__MODULE.html#ga8e2f6ba4de2ec70859f37324e6aa65ba">MCSPI_OpenParams_init</a>(&amp;spiParams);      <span class="comment">/* Initialize SPI parameters */</span></div>
<div class="line">    spiParams.<a class="code" href="structMCSPI__OpenParams.html#a0b4ecaba7263bd18bc7e40924d8d6c97">transferMode</a>  = <a class="code" href="group__DRV__MCSPI__MODULE.html#gab50fd130c0f0d29545a83be89f230b8e">MCSPI_TRANSFER_MODE_BLOCKING</a>;</div>
<div class="line">    gMcspiHandle = <a class="code" href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923">MCSPI_open</a>(CONFIG_MCSPI0, &amp;spiParams);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(gMcspiHandle != NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Channel configuration */</span></div>
<div class="line">    <span class="keywordflow">for</span>(chCnt = 0U; chCnt &lt; APP_MCSPI_NUM_CH; chCnt++)</div>
<div class="line">    {</div>
<div class="line">        chCfg = &amp;gMcspiChConfig[chCnt];</div>
<div class="line">        <span class="comment">/* Init to default value */</span></div>
<div class="line">        <a class="code" href="group__DRV__MCSPI__MODULE.html#gab3158f44e2826e25f90111aa24453cc1">MCSPI_ChConfig_init</a>(chCfg);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Override based on need */</span></div>
<div class="line">        chCfg-&gt;<a class="code" href="structMCSPI__ChConfig.html#ab17c0ddea55b65e89f6def7ad26ae7b3">chNum</a> = chCnt;</div>
<div class="line">        chCfg-&gt;<a class="code" href="structMCSPI__ChConfig.html#a5617086b54dd1ff46d0baae70e988ee2">bitRate</a> = 2000000U;</div>
<div class="line">        chCfg-&gt;<a class="code" href="structMCSPI__ChConfig.html#a2b07488d7d440d8cb8c220de4ea398bd">dataSize</a> = 16U;</div>
<div class="line">        status = <a class="code" href="group__DRV__MCSPI__MODULE.html#gaf55bfd5fe8741647f107cacba32a04e3">MCSPI_chConfig</a>(gMcspiHandle, chCfg);</div>
<div class="line">        <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(status == <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a>);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Instance Close Example </p><div class="fragment"><div class="line">    <a class="code" href="group__DRV__MCSPI__MODULE.html#ga12824149d7be9c07abd4cb120ec7cf13">MCSPI_close</a>(gMcspiHandle);</div>
</div><!-- fragment --><p> Blocking Transfer Example </p><div class="fragment"><div class="line">    int32_t             transferOK;</div>
<div class="line">    <a class="code" href="structMCSPI__Transaction.html">MCSPI_Transaction</a>   spiTransaction;</div>
<div class="line">    uint8_t             transmitBuffer[APP_MCSPI_MSGSIZE];</div>
<div class="line">    uint8_t             receiveBuffer[APP_MCSPI_MSGSIZE];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Fill in transmitBuffer */</span></div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a69dc47581d6f116db83f816065866748">channel</a>  = 0U;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a03649a1e749d0661e4a78fbe615ce412">count</a>    = APP_MCSPI_MSGSIZE;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a1344bb4f68f64e6841a25884de818f7b">txBuf</a>    = (<span class="keywordtype">void</span> *)transmitBuffer;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a13379551362963f30946a9ef45d9efc9">rxBuf</a>    = (<span class="keywordtype">void</span> *)receiveBuffer;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a7789f4810d4b1818b3cd2a1cdd4a01cd">args</a>     = NULL;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initiate transfer */</span></div>
<div class="line">    transferOK = <a class="code" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9">MCSPI_transfer</a>(gMcspiHandle, &amp;spiTransaction);</div>
<div class="line">    <span class="keywordflow">if</span>((<a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a> != transferOK) ||</div>
<div class="line">       (<a class="code" href="group__DRV__MCSPI__MODULE.html#gaeb7c93069850e87483265149069539d1">MCSPI_TRANSFER_COMPLETED</a> != spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a5bd291f7ca72200e01074457999d9ef9">status</a>))</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* MCSPI transfer failed!! */</span></div>
<div class="line">        <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(FALSE);</div>
<div class="line">    }</div>
</div><!-- fragment --><p> Non-Blocking Transfer Example </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> App_callbackFxn(<a class="code" href="group__DRV__MCSPI__MODULE.html#ga859dbc47eb349c2d5df779923c1d5ac9">MCSPI_Handle</a> handle,</div>
<div class="line">                     <a class="code" href="structMCSPI__Transaction.html">MCSPI_Transaction</a> *transaction)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="structSemaphoreP__Object.html">SemaphoreP_Object</a> *semObj;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>((NULL != transaction) &amp;&amp;</div>
<div class="line">       (<a class="code" href="group__DRV__MCSPI__MODULE.html#gaeb7c93069850e87483265149069539d1">MCSPI_TRANSFER_COMPLETED</a> == transaction-&gt;<a class="code" href="structMCSPI__Transaction.html#a5bd291f7ca72200e01074457999d9ef9">status</a>))</div>
<div class="line">    {</div>
<div class="line">        semObj = (<a class="code" href="structSemaphoreP__Object.html">SemaphoreP_Object</a> *) transaction-&gt;<a class="code" href="structMCSPI__Transaction.html#a7789f4810d4b1818b3cd2a1cdd4a01cd">args</a>;</div>
<div class="line">        <span class="keywordflow">if</span>(NULL != semObj)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="group__KERNEL__DPL__SEMAPHORE.html#ga23075425da4d8a65a53209b5fdd3fafe">SemaphoreP_post</a>(semObj);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> transfer_nonblocking(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    int32_t             status;</div>
<div class="line">    int32_t             transferOK;</div>
<div class="line">    <a class="code" href="structMCSPI__OpenParams.html">MCSPI_OpenParams</a>    spiParams;</div>
<div class="line">    <a class="code" href="structMCSPI__Transaction.html">MCSPI_Transaction</a>   spiTransaction;</div>
<div class="line">    uint8_t             transmitBuffer[APP_MCSPI_MSGSIZE];</div>
<div class="line">    uint8_t             receiveBuffer[APP_MCSPI_MSGSIZE];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__DRV__MCSPI__MODULE.html#ga8e2f6ba4de2ec70859f37324e6aa65ba">MCSPI_OpenParams_init</a>(&amp;spiParams);      <span class="comment">/* Initialize SPI parameters */</span></div>
<div class="line">    spiParams.<a class="code" href="structMCSPI__OpenParams.html#a0b4ecaba7263bd18bc7e40924d8d6c97">transferMode</a>          = <a class="code" href="group__DRV__MCSPI__MODULE.html#gab2e9e948624aa8ff39cc5a75e00adb6f">MCSPI_TRANSFER_MODE_CALLBACK</a>;</div>
<div class="line">    spiParams.<a class="code" href="structMCSPI__OpenParams.html#a43a61b1bdcb52eebaf0d756f5e5500d8">transferCallbackFxn</a>   = &amp;App_callbackFxn;</div>
<div class="line">    gMcspiHandle = <a class="code" href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923">MCSPI_open</a>(CONFIG_MCSPI0, &amp;spiParams);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(gMcspiHandle != NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Fill in transmitBuffer */</span></div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a69dc47581d6f116db83f816065866748">channel</a>  = 0U;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a03649a1e749d0661e4a78fbe615ce412">count</a>    = APP_MCSPI_MSGSIZE;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a1344bb4f68f64e6841a25884de818f7b">txBuf</a>    = (<span class="keywordtype">void</span> *)transmitBuffer;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a13379551362963f30946a9ef45d9efc9">rxBuf</a>    = (<span class="keywordtype">void</span> *)receiveBuffer;</div>
<div class="line">    spiTransaction.<a class="code" href="structMCSPI__Transaction.html#a7789f4810d4b1818b3cd2a1cdd4a01cd">args</a>     = &amp;gMcspiISRDoneSem;    <span class="comment">/* Pass semaphore */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initiate transfer */</span></div>
<div class="line">    transferOK = <a class="code" href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9">MCSPI_transfer</a>(gMcspiHandle, &amp;spiTransaction);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(transferOK == <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Wait for callback */</span></div>
<div class="line">    status = <a class="code" href="group__KERNEL__DPL__SEMAPHORE.html#ga8733f9edac3a2d559b97dc0d115c3ba8">SemaphoreP_pend</a>(&amp;gMcspiISRDoneSem, <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga376db5d2fbbc54611736778be8e15431">SystemP_WAIT_FOREVER</a>);</div>
<div class="line">    <a class="code" href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a>(status == <a class="code" href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a>);</div>
<div class="line">}</div>
</div><!-- fragment --> <h1><a class="anchor" id="autotoc_md536"></a>
API</h1>
<p><a class="el" href="group__DRV__MCSPI__MODULE.html">APIs for MCSPI</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_ga12824149d7be9c07abd4cb120ec7cf13"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#ga12824149d7be9c07abd4cb120ec7cf13">MCSPI_close</a></div><div class="ttdeci">void MCSPI_close(MCSPI_Handle handle)</div><div class="ttdoc">Function to close a MCSPI peripheral specified by the MCSPI handle.</div></div>
<div class="ttc" id="astructMCSPI__Transaction_html_a03649a1e749d0661e4a78fbe615ce412"><div class="ttname"><a href="structMCSPI__Transaction.html#a03649a1e749d0661e4a78fbe615ce412">MCSPI_Transaction::count</a></div><div class="ttdeci">uint32_t count</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:335</div></div>
<div class="ttc" id="astructMCSPI__Transaction_html_a5bd291f7ca72200e01074457999d9ef9"><div class="ttname"><a href="structMCSPI__Transaction.html#a5bd291f7ca72200e01074457999d9ef9">MCSPI_Transaction::status</a></div><div class="ttdeci">uint32_t status</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:358</div></div>
<div class="ttc" id="astructMCSPI__Transaction_html"><div class="ttname"><a href="structMCSPI__Transaction.html">MCSPI_Transaction</a></div><div class="ttdoc">Data structure used with MCSPI_transfer()</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:331</div></div>
<div class="ttc" id="astructMCSPI__OpenParams_html_a0b4ecaba7263bd18bc7e40924d8d6c97"><div class="ttname"><a href="structMCSPI__OpenParams.html#a0b4ecaba7263bd18bc7e40924d8d6c97">MCSPI_OpenParams::transferMode</a></div><div class="ttdeci">uint32_t transferMode</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:384</div></div>
<div class="ttc" id="astructMCSPI__ChConfig_html_a5617086b54dd1ff46d0baae70e988ee2"><div class="ttname"><a href="structMCSPI__ChConfig.html#a5617086b54dd1ff46d0baae70e988ee2">MCSPI_ChConfig::bitRate</a></div><div class="ttdeci">uint32_t bitRate</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:411</div></div>
<div class="ttc" id="astructMCSPI__OpenParams_html"><div class="ttname"><a href="structMCSPI__OpenParams.html">MCSPI_OpenParams</a></div><div class="ttdoc">MCSPI Parameters.</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:383</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__SYSTEM_html_ga376db5d2fbbc54611736778be8e15431"><div class="ttname"><a href="group__KERNEL__DPL__SYSTEM.html#ga376db5d2fbbc54611736778be8e15431">SystemP_WAIT_FOREVER</a></div><div class="ttdeci">#define SystemP_WAIT_FOREVER</div><div class="ttdoc">Value to use when needing a timeout of infinity or wait forver until resource is available.</div><div class="ttdef"><b>Definition:</b> SystemP.h:83</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_ga859dbc47eb349c2d5df779923c1d5ac9"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#ga859dbc47eb349c2d5df779923c1d5ac9">MCSPI_Handle</a></div><div class="ttdeci">void * MCSPI_Handle</div><div class="ttdoc">A handle that is returned from a MCSPI_open() call.</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:74</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_gab50fd130c0f0d29545a83be89f230b8e"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#gab50fd130c0f0d29545a83be89f230b8e">MCSPI_TRANSFER_MODE_BLOCKING</a></div><div class="ttdeci">#define MCSPI_TRANSFER_MODE_BLOCKING</div><div class="ttdoc">MCSPI_transfer() blocks execution. This mode can only be used when called within a Task context</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:129</div></div>
<div class="ttc" id="astructMCSPI__ChConfig_html_a2b07488d7d440d8cb8c220de4ea398bd"><div class="ttname"><a href="structMCSPI__ChConfig.html#a2b07488d7d440d8cb8c220de4ea398bd">MCSPI_ChConfig::dataSize</a></div><div class="ttdeci">uint32_t dataSize</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:415</div></div>
<div class="ttc" id="amcspi_8h_html"><div class="ttname"><a href="mcspi_8h.html">mcspi.h</a></div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_ga35061166ed36e50dc6d7b38a8fbf13e9"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#ga35061166ed36e50dc6d7b38a8fbf13e9">MCSPI_transfer</a></div><div class="ttdeci">int32_t MCSPI_transfer(MCSPI_Handle handle, MCSPI_Transaction *transaction)</div><div class="ttdoc">Function to perform MCSPI transactions.</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__SYSTEM_html_ga47e638d7c694e6d42e57b96b071b8a6f"><div class="ttname"><a href="group__KERNEL__DPL__SYSTEM.html#ga47e638d7c694e6d42e57b96b071b8a6f">SystemP_SUCCESS</a></div><div class="ttdeci">#define SystemP_SUCCESS</div><div class="ttdoc">Return status when the API execution was successful.</div><div class="ttdef"><b>Definition:</b> SystemP.h:56</div></div>
<div class="ttc" id="astructMCSPI__Transaction_html_a7789f4810d4b1818b3cd2a1cdd4a01cd"><div class="ttname"><a href="structMCSPI__Transaction.html#a7789f4810d4b1818b3cd2a1cdd4a01cd">MCSPI_Transaction::args</a></div><div class="ttdeci">void * args</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:356</div></div>
<div class="ttc" id="astructMCSPI__Transaction_html_a1344bb4f68f64e6841a25884de818f7b"><div class="ttname"><a href="structMCSPI__Transaction.html#a1344bb4f68f64e6841a25884de818f7b">MCSPI_Transaction::txBuf</a></div><div class="ttdeci">void * txBuf</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:338</div></div>
<div class="ttc" id="astructMCSPI__Transaction_html_a13379551362963f30946a9ef45d9efc9"><div class="ttname"><a href="structMCSPI__Transaction.html#a13379551362963f30946a9ef45d9efc9">MCSPI_Transaction::rxBuf</a></div><div class="ttdeci">void * rxBuf</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:349</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_gab3158f44e2826e25f90111aa24453cc1"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#gab3158f44e2826e25f90111aa24453cc1">MCSPI_ChConfig_init</a></div><div class="ttdeci">static void MCSPI_ChConfig_init(MCSPI_ChConfig *chConfig)</div><div class="ttdoc">Function to initialize the MCSPI_ChConfig struct to its defaults.</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:747</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_gaf55bfd5fe8741647f107cacba32a04e3"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#gaf55bfd5fe8741647f107cacba32a04e3">MCSPI_chConfig</a></div><div class="ttdeci">int32_t MCSPI_chConfig(MCSPI_Handle handle, const MCSPI_ChConfig *chCfg)</div><div class="ttdoc">Function to configure a MCSPI channel.</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_ga8e2f6ba4de2ec70859f37324e6aa65ba"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#ga8e2f6ba4de2ec70859f37324e6aa65ba">MCSPI_OpenParams_init</a></div><div class="ttdeci">static void MCSPI_OpenParams_init(MCSPI_OpenParams *openPrms)</div><div class="ttdoc">Function to initialize the MCSPI_OpenParams struct to its defaults.</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:736</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__SEMAPHORE_html_ga23075425da4d8a65a53209b5fdd3fafe"><div class="ttname"><a href="group__KERNEL__DPL__SEMAPHORE.html#ga23075425da4d8a65a53209b5fdd3fafe">SemaphoreP_post</a></div><div class="ttdeci">void SemaphoreP_post(SemaphoreP_Object *obj)</div><div class="ttdoc">Post a semaphore object or unlock a mutex.</div></div>
<div class="ttc" id="astructSemaphoreP__Object_html"><div class="ttname"><a href="structSemaphoreP__Object.html">SemaphoreP_Object</a></div><div class="ttdoc">Opaque semaphore object used with the semaphore APIs.</div><div class="ttdef"><b>Definition:</b> SemaphoreP.h:59</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_gaeb7c93069850e87483265149069539d1"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#gaeb7c93069850e87483265149069539d1">MCSPI_TRANSFER_COMPLETED</a></div><div class="ttdeci">#define MCSPI_TRANSFER_COMPLETED</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:102</div></div>
<div class="ttc" id="astructMCSPI__Transaction_html_a69dc47581d6f116db83f816065866748"><div class="ttname"><a href="structMCSPI__Transaction.html#a69dc47581d6f116db83f816065866748">MCSPI_Transaction::channel</a></div><div class="ttdeci">uint32_t channel</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:332</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__DEBUG_html_ga552e9055ca7eab5fe6c224c6cd5a9d4c"><div class="ttname"><a href="group__KERNEL__DPL__DEBUG.html#ga552e9055ca7eab5fe6c224c6cd5a9d4c">DebugP_assert</a></div><div class="ttdeci">#define DebugP_assert(expression)</div><div class="ttdoc">Function to call for assert check.</div><div class="ttdef"><b>Definition:</b> DebugP.h:159</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_gabedb148b6832d0c132352b9c4fd0a923"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#gabedb148b6832d0c132352b9c4fd0a923">MCSPI_open</a></div><div class="ttdeci">MCSPI_Handle MCSPI_open(uint32_t index, const MCSPI_OpenParams *openPrms)</div><div class="ttdoc">This function opens a given MCSPI peripheral.</div></div>
<div class="ttc" id="astructMCSPI__ChConfig_html"><div class="ttname"><a href="structMCSPI__ChConfig.html">MCSPI_ChConfig</a></div><div class="ttdoc">MCSPI configuration parameters for the channel.</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:406</div></div>
<div class="ttc" id="astructMCSPI__OpenParams_html_a43a61b1bdcb52eebaf0d756f5e5500d8"><div class="ttname"><a href="structMCSPI__OpenParams.html#a43a61b1bdcb52eebaf0d756f5e5500d8">MCSPI_OpenParams::transferCallbackFxn</a></div><div class="ttdeci">MCSPI_CallbackFxn transferCallbackFxn</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:388</div></div>
<div class="ttc" id="agroup__KERNEL__DPL__SEMAPHORE_html_ga8733f9edac3a2d559b97dc0d115c3ba8"><div class="ttname"><a href="group__KERNEL__DPL__SEMAPHORE.html#ga8733f9edac3a2d559b97dc0d115c3ba8">SemaphoreP_pend</a></div><div class="ttdeci">int32_t SemaphoreP_pend(SemaphoreP_Object *obj, uint32_t timeToWaitInTicks)</div><div class="ttdoc">Pend on a semaphore object or lock a mutex.</div></div>
<div class="ttc" id="astructMCSPI__ChConfig_html_ab17c0ddea55b65e89f6def7ad26ae7b3"><div class="ttname"><a href="structMCSPI__ChConfig.html#ab17c0ddea55b65e89f6def7ad26ae7b3">MCSPI_ChConfig::chNum</a></div><div class="ttdeci">uint32_t chNum</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:407</div></div>
<div class="ttc" id="agroup__DRV__MCSPI__MODULE_html_gab2e9e948624aa8ff39cc5a75e00adb6f"><div class="ttname"><a href="group__DRV__MCSPI__MODULE.html#gab2e9e948624aa8ff39cc5a75e00adb6f">MCSPI_TRANSFER_MODE_CALLBACK</a></div><div class="ttdeci">#define MCSPI_TRANSFER_MODE_CALLBACK</div><div class="ttdoc">MCSPI_transfer() does not block code execution and will call a MCSPI_CallbackFxn. This mode can be us...</div><div class="ttdef"><b>Definition:</b> mcspi/v0/mcspi.h:134</div></div>
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
