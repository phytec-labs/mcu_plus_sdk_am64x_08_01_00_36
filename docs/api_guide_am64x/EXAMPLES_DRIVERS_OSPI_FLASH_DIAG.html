<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: OSPI Flash Diagnostic</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">08.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_DRIVERS_OSPI_FLASH_DIAG.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">OSPI Flash Diagnostic </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md987">Introduction</a></li>
<li class="level1"><a href="#EXAMPLES_DRIVERS_OSPI_FLASH_DIAG_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md988">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md989">See Also</a></li>
<li class="level1"><a href="#autotoc_md990">Sample Output</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_drivers_ospi_flash_diag"></a></p>
<h1><a class="anchor" id="autotoc_md987"></a>
Introduction</h1>
<p>This is a diagnostic example for NOR-OSPI Flashes. This example doesn't use the flash driver and should ideally pass for any NOR-OSPI flash. For this particular example, the options in SysCfg like the number of transfer lines used, or the clock divider value are ignored. This example will always talk to the flash in the lowest settings possible. The flash device is reset, and is expected to support 1s1s1s mode after reset. Then the OSPI controller is programmed to work in 1s1s1s mode with 3 byte addressing mode.</p>
<p>The test itself is simple, first it tries to read the JEDEC ID of the flash which consists of the flash manufacturer ID and the flash device ID. These are then printed onto the logging console. When doing flash bring-ups in new boards, this example can be run first for sanity. Users can cross check the printed ID with the one in flash datasheet to confirm that basic communication with flash is working.</p>
<p>The test then tries to erase a flash memory block at an offset of 512 KB and then write some known data to that memory. This data is then read back and verified to confirm that reads and writes are working in 1s1s1s mode.</p>
<h1><a class="anchor" id="EXAMPLES_DRIVERS_OSPI_FLASH_DIAG_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 nortos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am64x-evm   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/drivers/ospi/ospi_flash_diag   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md988"></a>
Steps to Run the Example</h1>
<ul>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>)</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md989"></a>
See Also</h1>
<p><a class="el" href="DRIVERS_OSPI_PAGE.html">OSPI</a></p>
<h1><a class="anchor" id="autotoc_md990"></a>
Sample Output</h1>
<div class="fragment"><div class="line">[OSPI Flash Diagnostic Test] Starting ...</div>
<div class="line">[OSPI Flash Diagnostic Test] Flash Manufacturer ID : 0x34</div>
<div class="line">[OSPI Flash Diagnostic Test] Flash Device ID       : 0x5B1A</div>
<div class="line">[OSPI Flash Diagnostic Test] Executing Flash Erase on first block...</div>
<div class="line">[OSPI Flash Diagnostic Test] Done !!!</div>
<div class="line">[OSPI Flash Diagnostic Test] Performing Write-Read Test...</div>
<div class="line">[OSPI Flash Diagnostic Test] Write-Read Test Passed!</div>
<div class="line">[OSPI Flash Diagnostic Test] SFDP Information : </div>
<div class="line">================================================</div>
<div class="line">                      SFDP                      </div>
<div class="line">================================================</div>
<div class="line">SFDP Major Revision                       : 0x1</div>
<div class="line">SFDP Minor Revision                       : 0x8</div>
<div class="line">Number of Parameter Headers in this Table : 6</div>
<div class="line"> </div>
<div class="line">Types of Additional Parameter Tables in this flash</div>
<div class="line">---------------------------------------------------</div>
<div class="line">4 BYTE ADDRESSING MODE INSTRUCTIONS TABLE</div>
<div class="line">XSPI PROFILE TABLE </div>
<div class="line">STATUS CONTROL AND CONFIGURATION REGISTER MAP TABLE</div>
<div class="line">OCTAL DDR MODE COMMAND SEQUENCE TABLE</div>
<div class="line">SECTOR MAP TABLE</div>
<div class="line"> </div>
<div class="line">Parsing of OCTAL DDR MODE COMMAND SEQUENCE TABLE table not yet supported. </div>
<div class="line"> </div>
<div class="line">Flash_NorXspiDevDefines gFlashNorXspiDeviceDefines_&lt;part-number&gt; = {</div>
<div class="line"> </div>
<div class="line">    .XSPI_NOR_CMD_RSTEN = 0x66,</div>
<div class="line">    .XSPI_NOR_CMD_RSTMEM = 0x99,</div>
<div class="line">    .XSPI_NOR_CMD_WREN = 0x06,</div>
<div class="line">    .XSPI_NOR_CMD_WRREG = 0x71,</div>
<div class="line">    .XSPI_NOR_CMD_BULK_ERASE = 0xC7,</div>
<div class="line">    .XSPI_NOR_CMD_SECTOR_ERASE_3B = 0x21,</div>
<div class="line">    .XSPI_NOR_CMD_SECTOR_ERASE_4B = 0x21,</div>
<div class="line">    .XSPI_NOR_CMD_BLOCK_ERASE_3B = 0xDC,</div>
<div class="line">    .XSPI_NOR_CMD_BLOCK_ERASE_4B = 0xDC,</div>
<div class="line">    .XSPI_NOR_CMD_PAGE_PROG_3B = 0x02,</div>
<div class="line">    .XSPI_NOR_CMD_PAGE_PROG_4B = 0x12,</div>
<div class="line">    .XSPI_NOR_CMD_RDSR = 0x05,</div>
<div class="line">    .XSPI_NOR_CMD_RDREG = 0x65,</div>
<div class="line">    .XSPI_NOR_CMD_RDID = 0x9F,</div>
<div class="line">    .XSPI_NOR_CMD_READ = 0x03,</div>
<div class="line">    .XSPI_NOR_CMD_888_SDR_READ = 0x00,</div>
<div class="line">    .XSPI_NOR_CMD_888_DDR_READ = 0xEE,</div>
<div class="line">    .XSPI_NOR_CMD_444_SDR_READ = 0x00,</div>
<div class="line">    .XSPI_NOR_CMD_444_DDR_READ = 0x00,</div>
<div class="line">    .XSPI_NOR_CMD_114_READ = 0x00,</div>
<div class="line">    .XSPI_NOR_SR_WIP = 1,</div>
<div class="line">    .XSPI_NOR_SR_WEL = 2,</div>
<div class="line">    .XSPI_NOR_RDID_NUM_BYTES = 5,</div>
<div class="line">    .XSPI_NOR_MANF_ID = 0x34,</div>
<div class="line">    .XSPI_NOR_DEVICE_ID = 0x5B1A,</div>
<div class="line">    .XSPI_NOR_114_READ_MODE_CLKS = 0,</div>
<div class="line">    .XSPI_NOR_114_READ_DUMMY_CYCLES = 0,</div>
<div class="line">    .XSPI_NOR_444_READ_MODE_CLKS = 0,</div>
<div class="line">    .XSPI_NOR_444_READ_DUMMY_CYCLES = 0,</div>
<div class="line">    .XSPI_NOR_444_READ_DUMMY_CYCLES_LC = 0xFF,</div>
<div class="line">    .XSPI_NOR_QUAD_CMD_READ_DUMMY_CYCLES = 0x00,</div>
<div class="line">    .XSPI_NOR_OCTAL_READ_DUMMY_CYCLE = 24,</div>
<div class="line">    .XSPI_NOR_OCTAL_READ_DUMMY_CYCLE_LC = 0x0B,</div>
<div class="line">    .XSPI_NOR_OCTAL_DDR_RDSR_DUMMY_CYCLE = 4,</div>
<div class="line">    .XSPI_NOR_OCTAL_DDR_RDREG_ADDR_BYTES = 4, </div>
<div class="line">    .XSPI_NOR_OCTAL_DDR_WRREG_ADDR_BYTES = 4, </div>
<div class="line">    .XSPI_NOR_OCTAL_DDR_RDVREG_DUMMY_CYCLE = 4, </div>
<div class="line">    .XSPI_NOR_OCTAL_DDR_RDNVREG_DUMMY_CYCLE = 8, </div>
<div class="line">    .XSPI_NOR_OCTAL_RDSFDP_DUMMY_CYCLE = 8, </div>
<div class="line">    .XSPI_NOR_OCTAL_RDSFDP_ADDR_TYPE = 0, </div>
<div class="line">    .XSPI_NOR_WRR_WRITE_TIMEOUT = 5120,</div>
<div class="line">    .XSPI_NOR_BULK_ERASE_TIMEOUT = 256000000,</div>
<div class="line">    .XSPI_NOR_PAGE_PROG_TIMEOUT = 512,</div>
<div class="line">    .XSPI_NOR_VREG_OFFSET = 0x800000,</div>
<div class="line">    .XSPI_NOR_NVREG_OFFSET = 0x0,</div>
<div class="line">    .XSPI_NOR_QUAD_MODE_CFG_ADDR = 0x0,</div>
<div class="line">    .XSPI_NOR_QUAD_MODE_CFG_BIT_LOCATION = 0x0,</div>
<div class="line">    .XSPI_NOR_DDR_OCTAL_MODE_CFG_ADDR = 0x6,</div>
<div class="line">    .XSPI_NOR_DDR_OCTAL_MODE_CFG_BIT_LOCATION = 0x1,</div>
<div class="line">    .XSPI_NOR_DUMMY_CYCLE_CFG_ADDR = 0x3,</div>
<div class="line">    .XSPI_NOR_FLASH_SIZE = 67108864,</div>
<div class="line">    .XSPI_NOR_PAGE_SIZE = 256,</div>
<div class="line">    .XSPI_NOR_BLOCK_SIZE = 262144,</div>
<div class="line">    .XSPI_NOR_SECTOR_SIZE = 4096,</div>
<div class="line">    .addrByteSupport = 1,</div>
<div class="line">    .dtrSupport = 1,</div>
<div class="line">    .qeType = 0,</div>
<div class="line">    .seq444Enable = { 0, 0, 0, 0, 0 },</div>
<div class="line">    .seq444Disable = { 0, 0, 0, 0 },</div>
<div class="line">    .oeType = 0,</div>
<div class="line">    .cmdExtType = 0,</div>
<div class="line">    .byteOrder = 0,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">All tests have passed!!</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
