<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: EtherCAT Slave Beckhoff SSC Demo</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">08.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('EXAMPLES_INDUSTRIAL_COMMS_ETHERCAT_SLAVE_BECKHOFF_SSC_DEMO.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">EtherCAT Slave Beckhoff SSC Demo </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md1135">Introduction</a></li>
<li class="level1"><a href="#EXAMPLES_INDUSTRIAL_COMMS_ETHERCAT_SLAVE_BECKHOFF_SSC_DEMO_COMBOS">Supported Combinations</a></li>
<li class="level1"><a href="#autotoc_md1136">Performance Benchmarking</a><ul><li class="level2"><a href="#autotoc_md1137">Cycle Time</a></li>
<li class="level2"><a href="#autotoc_md1138">Interrupt Processing Time</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md1139">Steps to Run the Example</a></li>
<li class="level1"><a href="#autotoc_md1140">Sample Output</a></li>
<li class="level1"><a href="#autotoc_md1141">See Also</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_examples_industrial_comms_ethercat_slave_beckhoff_ssc_demo"></a></p>
<h1><a class="anchor" id="autotoc_md1135"></a>
Introduction</h1>
<p>This example is a EtherCAT Slave application based on EtherCAT Slave Stack Code (SSC) from Beckhoff.</p>
<p>The example does the below</p><ul>
<li>Initializes the EtherCAT Slave stack</li>
<li>Initializes the FWHAL, which kicks off the ESC</li>
<li>Slave is taken to INIT state. It can be move to OP (operational) state by connecting it to a EtherCAT master, and process data communication is possible after that.</li>
<li>Allows user to control 8 LEDs using an EtherCAT master</li>
<li>Allows Online Application Upgrade, if loaded using SBL OSPI</li>
</ul>
<h1><a class="anchor" id="EXAMPLES_INDUSTRIAL_COMMS_ETHERCAT_SLAVE_BECKHOFF_SSC_DEMO_COMBOS"></a>
Supported Combinations</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter  </th><th class="markdownTableHeadNone">Value   </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPU + OS  </td><td class="markdownTableBodyNone">r5fss0-0 freertos   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ICSSG  </td><td class="markdownTableBodyNone">ICSSG1   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Toolchain  </td><td class="markdownTableBodyNone">ti-arm-clang   </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Board  </td><td class="markdownTableBodyNone">am64x-evm   </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Example folder  </td><td class="markdownTableBodyNone">examples/industrial_comms/ethercat_slave_beckhoff_ssc_demo   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md1136"></a>
Performance Benchmarking</h1>
<p>TwinCAT Master was used as the EtherCAT master for these tests.</p>
<h2><a class="anchor" id="autotoc_md1137"></a>
Cycle Time</h2>
<p>Lowest cycle time tested is <b>31.25 us(microseconds)</b> with Distributed Clock(DC) Synchronization mode.</p>
<h2><a class="anchor" id="autotoc_md1138"></a>
Interrupt Processing Time</h2>
<p>Following is the interrupt processing time for PDI and Sync ISRs with 50 us cycle time. The RxPDO size is 5 bytes and TxPDO size is 7 bytes in this example.</p>
<table class="doxtable">
<tr>
<th>Scenario </th><th>PDI ISR Processing Time (microseconds) </th><th>SYNC0 ISR Processing Time (microseconds) </th><th>SYNC1 ISR Processing Time (microseconds)  </th></tr>
<tr>
<td>DC mode with SYNC0 enabled </td><td>2.7 </td><td>3.2 </td><td>0  </td></tr>
<tr>
<td>DC mode with SYNC0 and SYNC1 enabled </td><td>2.7 </td><td>0.8 </td><td>2.6  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md1139"></a>
Steps to Run the Example</h1>
<ul>
<li>To build this example, it is necessary to get the EtherCAT Slave Stack Code (SSC). Download EtherCAT stack version 5.12 from <a href="http://www.ethercat.org/">ETG website</a> and extract it to a local folder. Please refer to "Application Note ET9300 (EtherCAT Slave Stack Code)" for more details on SSC.</li>
<li>Generate the patched EtherCAT Slave stack code source files using any one of the below mentioned methods:<ul>
<li><b>Using the patch file</b><ul>
<li>Copy the EtherCAT Slave Stack files to <code>{SDK_INSTALL_PATH}/source/industrial_comms/ethercat_slave/beckhoff_stack/stack_sources/</code> folder.</li>
<li>Download Windows Patch Utility from <a href="http://gnuwin32.sourceforge.net/downlinks/patch-bin-zip.php">gnuwin32 sourceforge</a>. (Note that this is not a TI tool. See <a href="http://savannah.gnu.org/projects/patch/">licensing information</a> page for more details)</li>
<li>Download Dos2Unix/Unix2Dos-Text file format converters from <a href="https://sourceforge.net/projects/dos2unix/">gnuwin32 sourceforge</a>. (Note that this is not a TI tool. See <a href="http://www.freebsd.org/copyright/freebsd-license.html">licensing information</a> page for more details)</li>
<li>Patch file utility(Patch.exe) and unix2dos.exe utility can be found in their bin folders.</li>
<li>Launch DOS Command prompt</li>
<li>CD to the folder <code>${SDK_INSTALL_PATH}/source/industrial_comms/ethercat_slave/beckhoff_stack/patch</code> which contains TI_ECAT.patch.</li>
<li>Execute unix2dos.exe as given below: <div class="fragment"><div class="line">$(Dos2Unix/Unix2Dos-DIR)/bin/unix2dos.exe TI_ECAT.patch</div>
</div><!-- fragment --></li>
<li>CD to patch file utility bin folder.</li>
<li>Execute patch.exe as given below: <div class="fragment"><div class="line">patch.exe -i ${SDK_INSTALL_PATH}/source/industrial_comms/ethercat_slave/beckhoff_stack/patch/TI_ECAT.patch -d ${SDK_INSTALL_PATH}/source/industrial_comms/ethercat_slave/beckhoff_stack/stack_sources/</div>
</div><!-- fragment --></li>
</ul>
</li>
<li><b>Using Beckhoff SSC Tool</b><ul>
<li>Install SSC tool version 1.4.0.0. This configuration tool facilitates working with the EtherCAT Slave Stack Code (SSC), as it allows reducing the size of the EtherCAT slave stack code by removing unused code parts depending on the desired configuration. Objects should be defined in a .xlsx file. Please refer to <a href="https://download.beckhoff.com/download/document/io/ethercat-development-products/ethercat_slave_design_quick_guide.pdf">EtherCAT Slave Design - Quick Guide</a> for details.</li>
<li>Click on "Import" button and select TI_ESC_[SDK_VERSION].xml present in SoC specific folder inside <code>${SDK_INSTALL_PATH}/source/industrial_comms/ethercat_slave/beckhoff_stack/patch</code> folder.</li>
<li>Make sure "Custom" is selected in the dialog box and "TI [SOC] Sample \&lt;Texas Instruments Incorporated\&gt;" is selected from the list.</li>
<li>Set DC_SUPPORTED to 1 if not set.</li>
<li>Save the project.</li>
<li>Click "Project-&gt;Create new Slave Files". This will generate the EtherCAT Source files specific to the the selected TI device.</li>
<li>Copy the generated files to <code>${SDK_INSTALL_PATH}/source/industrial_comms/ethercat_slave/beckhoff_stack/stack_sources/</code>.</li>
</ul>
</li>
</ul>
</li>
<li>Change macro defintions in <code>{SDK_INSTALL_PATH}/source/industrial_comms/ethercat_slave/beckhoff_stack/stack_sources/ecat_def.h</code>, if required for your application. Please ensure that TIESC_HW is set to 1, and TIESC_APPLICATION is set to 1.</li>
<li><b>When using CCS projects to build</b>, import the CCS project for the required combination and build it using the CCS project menu (see <a class="el" href="CCS_PROJECTS_PAGE.html">Using SDK with CCS Projects</a>).</li>
<li><b>When using makefiles to build</b>, note the required combination and build using make command (see <a class="el" href="MAKEFILE_BUILD_PAGE.html">Using SDK with Makefiles</a>)</li>
<li>Launch a CCS debug session and run the executable, see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a></li>
<li>To test the application, one can use TwinCAT or any other compatible EtherCAT master. The steps to test the slave with TwinCAT are present in <a class="el" href="ETHERCAT_SLAVE_DEMO_TWINCAT.html">EtherCAT Slave Setup with TwinCAT</a>.</li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>If you need to reload and run again, a CPU power-cycle is MUST</dd></dl>
<h1><a class="anchor" id="autotoc_md1140"></a>
Sample Output</h1>
<p>Shown below is a sample output when the application is run:</p>
<div class="fragment"><div class="line">EtherCAT Device</div>
<div class="line">EtherCAT Sample application</div>
<div class="line">Revision/Type : x0590 Build : x04F3</div>
<div class="line">Firmware Version : 5.4.243</div>
<div class="line">SYNC0 task started</div>
<div class="line">SYNC1 task started</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md1141"></a>
See Also</h1>
<p><a class="el" href="ETHERCAT_SLAVE_FWHAL.html">EtherCAT Slave FWHAL</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
