<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: Linker Command File Migration Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">08.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('LINKER_COMMAND_FILE_MIGRATION_GUIDE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Linker Command File Migration Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_migration_guides_linker_command_file_migration_guide"></a> This section describes the differences between linker command file syntax of MCU+ SDK and Processor SDK RTOS (PDK). This can be used as a migration aid when moving from Processor SDK RTOS (PDK) to MCU+ SDK. Compiler used in MCU+ SDK is TIARMCLANG. </p>
<h1><a class="anchor" id="autotoc_md275"></a>
API changes</h1>
<p>To a large extent, linker command files for ARM applications that manage the placement of code and data generated by the armcl compiler will also work with object files that are generated by the tiarmclang compiler. However, below table mentions few adjustments that are needed to make your linker command file tiarmclang supportive. It also lists down the sections which are no longer required in MCU+ SDK.</p>
<table class="doxtable">
<tr>
<th>PDK(ARMCL) </th><th>MCU+ SDK(TIARMCLANG) </th><th>Remarks  </th></tr>
<tr>
<td>.bootCode </td><td>None </td><td>No longer required in MCU+ SDK.  </td></tr>
<tr>
<td>.startupCode </td><td>None </td><td>No longer required in MCU+ SDK.  </td></tr>
<tr>
<td>.startupData </td><td>None </td><td>No longer required in MCU+ SDK.  </td></tr>
<tr>
<td>.intvecs </td><td>None </td><td>No longer required in MCU+ SDK.  </td></tr>
<tr>
<td>.intc_text </td><td>None </td><td>No longer required in MCU+ SDK.  </td></tr>
<tr>
<td>.rstvectors </td><td>.vectors </td><td></td></tr>
<tr>
<td>&ndash;entry_point=_resetvectors </td><td>e_vectors </td><td>R5F entry point and vector table  </td></tr>
<tr>
<td>.const </td><td>.rodata </td><td></td></tr>
</table>
<h1><a class="anchor" id="autotoc_md276"></a>
Important Notes</h1>
<ul>
<li>In MCU+ SDK, R5F entry point, vector table, MUST be placed at 0x0 other than SBL</li>
<li>User ISR code get called in context of SVC stack, so size of SVC stack MUST be kept large enough to handle worst case ISR requirement.</li>
<li>The IRQ stack size itself can be kept small since it only saves few bytes (8 bytes) of state for every nested IRQ invocation.</li>
<li>SDK default examples keep IRQ stack as 256 bytes and SVC stack size as 4096 bytes.</li>
<li>This stack size is specified in the linker command file, a sample snippet is shown below, <div class="fragment"><div class="line">__IRQ_STACK_SIZE = 256;</div>
<div class="line">/* This is the size of stack when R5 is in IRQ mode</div>
<div class="line">* - In both NORTOS and FreeRTOS nesting is disabled for FIQ</div>
<div class="line">*/</div>
<div class="line">__FIQ_STACK_SIZE = 256;</div>
<div class="line">__SVC_STACK_SIZE = 4096; /* This is the size of stack when R5 is in SVC mode */</div>
<div class="line">__ABORT_STACK_SIZE = 256;  /* This is the size of stack when R5 is in ABORT mode */</div>
<div class="line">__UNDEFINED_STACK_SIZE = 256;  /* This is the size of stack when R5 is in UNDEF mode */</div>
</div><!-- fragment --></li>
<li>R5F boot code until MPU is enabled, MUST be at a address &lt; 0x80000000 i.e this cannot be placed in DDR <div class="fragment"><div class="line">GROUP {</div>
<div class="line">    .text.hwi: palign(8)</div>
<div class="line">    .text.cache: palign(8)</div>
<div class="line">    .text.mpu: palign(8)</div>
<div class="line">    .text.boot: palign(8)</div>
<div class="line">    .text:abort: palign(8) /* this helps in loading symbols when using XIP mode */</div>
<div class="line">} &gt; MSRAM</div>
</div><!-- fragment --></li>
<li>Below memory is reserved for DMSC usage. Security handoff is complete when this message is sent to the DMSC, TISCI_MSG_SEC_HANDOVER. This should be sent once all cores are loaded and all application specific firewall calls are setup. <div class="fragment"><div class="line">During Boot till security handoff is complete</div>
<div class="line">0x701E0000 - 0x701FFFFF (128KB)</div>
<div class="line">After &quot;Security Handoff&quot; is complete (i.e at run time)</div>
<div class="line">0x701FC000 - 0x701FFFFF (16KB)</div>
</div><!-- fragment --></li>
<li>Please refer section "Shared memory logging" in <a class="el" href="KERNEL_DPL_DEBUG_PAGE.html">Debug</a> on shared memory segments.</li>
</ul>
<h1><a class="anchor" id="autotoc_md277"></a>
See Also</h1>
<ul>
<li><a class="el" href="KERNEL_FREERTOS_IMPORTANT_GUIDELINES_PAGE.html">FreeRTOS usage guidelines</a></li>
<li><a class="el" href="KERNEL_DPL_DEBUG_PAGE.html">Debug</a></li>
<li><a class="el" href="ICSS_EMAC.html">ICSS-EMAC</a></li>
<li><a class="el" href="BOOTFLOW_GUIDE.html">Understanding the bootflow and bootloaders</a></li>
<li><a class="el" href="BOOTFLOW_XIP.html">Enabling XIP or eXecute In Place</a></li>
<li><a class="el" href="BOOTFLOW_GUIDE.html">Understanding the bootflow and bootloaders</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
