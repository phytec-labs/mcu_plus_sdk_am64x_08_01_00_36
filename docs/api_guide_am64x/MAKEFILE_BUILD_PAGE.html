<!-- HTML header for doxygen 1.8.11-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="shortcut icon" href="favicon.png" type="image/png">    
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>AM64x MCU+ SDK: Using SDK with Makefiles</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<style>
.tinav {
    background: #c00;
    /* height: 41.375px; */
    height: 30px;
    }
</style>    
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 40px;">
  <td id="projectlogo"><a href="https://www.ti.com"><img alt="Logo" src="ti_logo.svg"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AM64x MCU+ SDK
   &#160;<span id="projectnumber">08.01.00</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<div class=tinav></div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('MAKEFILE_BUILD_PAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Using SDK with Makefiles </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md147">Introduction</a></li>
<li class="level1"><a href="#autotoc_md148">Enabling &quot;make&quot; in Windows</a></li>
<li class="level1"><a href="#autotoc_md149">Building Libraries with Makefiles</a></li>
<li class="level1"><a href="#MAKEFILE_EXAMPLE_BUILD">Building examples with makefiles</a></li>
<li class="level1"><a href="#autotoc_md150">Building System Examples with Makefiles</a></li>
<li class="level1"><a href="#autotoc_md151">Building the Whole SDK with Makefiles</a></li>
<li class="level1"><a href="#autotoc_md152">Load and Run Executables Built with Makefiles</a></li>
<li class="level1"><a href="#autotoc_md153">Tips and Tricks when working with Makefiles</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_developer_guides_makefile_build"></a></p>
<dl class="section note"><dt>Note</dt><dd>The steps on this page show screen shots and description based on Windows. However the steps in Linux would remain the same, unless mentioned otherwise. </dd>
<dd>
In Linux, use <code>make</code> instead of <code>gmake</code></dd>
<dd>
The screen shots shown on this page are for AM64x MCU+ SDK v7.3.0. You would see your specific SOC and SDK version that is installed. However the instructions and steps mentioned remain the same, unless mentioned otherwise.</dd></dl>
<h1><a class="anchor" id="autotoc_md147"></a>
Introduction</h1>
<p>All SDK examples and libraries can be built using makefiles via command line. Using command line one can also open SysConfig GUI to configure the example. This section provides basic instructions and tips on using makefiles.</p>
<h1><a class="anchor" id="autotoc_md148"></a>
Enabling "make" in Windows</h1>
<dl class="section attention"><dt>Attention</dt><dd>This step needs to be done once on a Windows host machine. Nothing needs to be done for Linux.</dd></dl>
<ul>
<li>Windows, unlike Linux, does not come pre-installed with GNU make. CCS provides a GNU make executable. However the path to this GNU make executable should be visible to the windows command prompt.</li>
<li>To add "make" to your path environment variable do below,</li>
</ul>
<p> <style>div.image img[src="ccs_setup_03.png"]{width:20%}</style> </p><div class="image">
<img src="ccs_setup_03.png" alt=""/>
<div class="caption">
Add Environment Variable</div></div>
<ul>
<li>Edit the "Path" variable and add the path to C:/ti/ccs1100/ccs/utils/bin in the "Path" variable.</li>
<li>Confirm that you are able to see gmake in Windows by doing below <div class="fragment"><div class="line">C:\ti&gt;gmake -v</div>
</div><!-- fragment --></li>
<li>The expected output is shown below <div class="fragment"><div class="line">GNU Make 4.1</div>
<div class="line">Built for Windows32</div>
<div class="line">Copyright (C) 1988-2014 Free Software Foundation, Inc.</div>
<div class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</div>
<div class="line">This is free software: you are free to change and redistribute it.</div>
<div class="line">There is NO WARRANTY, to the extent permitted by law.</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="autotoc_md149"></a>
Building Libraries with Makefiles</h1>
<dl class="section note"><dt>Note</dt><dd>CCS projects are not supported for libraries and if any library source file or header file is modified the libraries need to be rebuilt as shown below</dd></dl>
<ul>
<li>When SDK is installed the drivers, FreeRTOS, NORTOS and other libraries are pre-built for both "debug" mode and "release" mode. However you can modify the library source code and rebuild all the libraries using makefiles.</li>
<li>To rebuild the libraries, do below, <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s libs PROFILE=release</div>
</div><!-- fragment --></li>
<li>To clean all library generated object files and libraries, do below <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s  libs-clean PROFILE=release</div>
</div><!-- fragment --></li>
<li>Additionally, you can pass <code>PROFILE=debug</code> to build the libraries without optimizations. This helps when debugging code in CCS debugger.</li>
</ul>
<h1><a class="anchor" id="MAKEFILE_EXAMPLE_BUILD"></a>
Building examples with makefiles</h1>
<ul>
<li>You can build example applications using CCS projects as well as makefiles.</li>
<li>To build using makefiles, firstly identify the example to build by doing below <div class="fragment"><div class="line">gmake -s help</div>
</div><!-- fragment --></li>
<li>This will list all the make "commands" that you can execute. A sample output snippet is shown below, <div class="fragment"><div class="line">\# Notes,</div>
<div class="line">\# - Use -j to invoke parallel builds</div>
<div class="line">\# - Use PROFILE=debug or PROFILE=release [default] to build in debug or release profile</div>
<div class="line">\#</div>
<div class="line">\# Overall build targets,</div>
<div class="line">\# ======================</div>
<div class="line">\# gmake -s -f makefile.{soc} help</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line">\# Example build targets,</div>
<div class="line">\# ======================</div>
<div class="line">\# gmake -s -C examples/kernel/dpl/hello_world/{board}/r5fss0-0_nortos/ti-arm-clang [all clean syscfg-gui syscfg]</div>
<div class="line">\# gmake -s -C examples/kernel/dpl/hello_world/{board}/r5fss0-0_freertos/ti-arm-clang [all clean syscfg-gui syscfg]</div>
<div class="line">\# gmake -s -C examples/kernel/dpl/hello_world/{board}/m4fss0-0_nortos/ti-arm-clang [all clean syscfg-gui syscfg]</div>
<div class="line">\# gmake -s -C examples/kernel/dpl/hello_world/{board}/m4fss0-0_freertos/ti-arm-clang [all clean syscfg-gui syscfg]</div>
<div class="line">...</div>
<div class="line">\# System Example build targets,</div>
<div class="line">\# =============================</div>
<div class="line">\# gmake -s -C examples/drivers/ipc/ipc_notify_echo/{board}/system_freertos_nortos [all clean syscfg-gui syscfg]</div>
<div class="line">\# gmake -s -C examples/drivers/ipc/ipc_rpmsg_echo/{board}/system_freertos_nortos [all clean syscfg-gui syscfg]</div>
<div class="line">...</div>
</div><!-- fragment --></li>
<li>All examples are arranged as below <div class="fragment"><div class="line">examples/{component or module}/{optional sub-module or sub-component}/</div>
<div class="line">               |</div>
<div class="line">               + -- {example name}/{board on which this example can run}/</div>
<div class="line">                                     |</div>
<div class="line">                                     + -- {cpu}_{os}/{compiler toolchain}</div>
</div><!-- fragment --></li>
<li>To build a given example pick the "example combo" that you want to build and copy-paste that command on the command prompt as below <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s -C examples/kernel/dpl/hello_world/{board}/m4fss0-0_freertos/ti-arm-clang all PROFILE=release</div>
</div><!-- fragment --></li>
<li>As shown above, one can also pass <code>PROFILE=release</code> or <code>PROFILE=debug</code> to build in "release" or "debug" profile.</li>
<li>Instead of "all" you can also pass other arguments as below.</li>
<li>To clean a example do, <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s -C examples/kernel/dpl/hello_world/{board}/r5fss0-0_freertos/ti-arm-clang clean PROFILE=release</div>
</div><!-- fragment --></li>
<li>To launch SysConfig GUI from command line for a example do, (see also <a class="el" href="SYSCONFIG_INTRO_PAGE.html">Using SDK with SysConfig</a>) <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s -C examples/kernel/dpl/hello_world/{board}/r5fss0-0_freertos/ti-arm-clang syscfg-gui</div>
</div><!-- fragment --></li>
<li>To simply build all examples, do below <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s  examples PROFILE=release</div>
</div><!-- fragment --></li>
<li>Explore additional commands listed via <code>gmake -s help</code> for more options</li>
</ul>
<h1><a class="anchor" id="autotoc_md150"></a>
Building System Examples with Makefiles</h1>
<ul>
<li>Some examples, to run correctly, need multiple binaries on different CPUs to be build, loaded and run. Such examples are called "system" examples. One such example is inter-processor communication example, which shows multiple CPUs communicating among each other.</li>
<li>These examples are listed under <code>System Example build targets</code> when <code>gmake -s help</code> is done <div class="fragment"><div class="line">...</div>
<div class="line">\# System Example build targets,</div>
<div class="line">\# =============================</div>
<div class="line">\# gmake -s -C examples/drivers/ipc/ipc_notify_echo/{board}/system_freertos_nortos [all clean syscfg-gui syscfg]</div>
<div class="line">\# gmake -s -C examples/drivers/ipc/ipc_rpmsg_echo/{board}/system_freertos_nortos [all clean syscfg-gui syscfg]</div>
<div class="line">...</div>
</div><!-- fragment --></li>
<li>When the command shown under "System Example ..." is executed, multiple makefiles are executed to build executables for all CPUs associated with that "system" example</li>
<li>You can also launch SysConfig using the system example makefile as shown in below example, (see also <a class="el" href="SYSCONFIG_INTRO_PAGE.html">Using SDK with SysConfig</a>) <div class="fragment"><div class="line">gmake -s -C examples/drivers/ipc/ipc_notify_echo/{board}/system_freertos_nortos syscfg-gui</div>
</div><!-- fragment --></li>
<li>Here SysConfig will show the configuration of all CPUs in a single SysConfig window.</li>
</ul>
<p> <style>div.image img[src="syscfg_00.png"]{width:70%}</style> </p><div class="image">
<img src="syscfg_00.png" alt=""/>
<div class="caption">
SysConfig Multi-CPU View</div></div>
<h1><a class="anchor" id="autotoc_md151"></a>
Building the Whole SDK with Makefiles</h1>
<ul>
<li>The whole SDK can be built using makefiles by running below command, <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s  all PROFILE=release</div>
</div><!-- fragment --></li>
<li>Similarly to clean the whole SDK, do below <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}</div>
<div class="line">gmake -s  clean PROFILE=release</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="autotoc_md152"></a>
Load and Run Executables Built with Makefiles</h1>
<ul>
<li>The generated binary from makefile is located as the below path <div class="fragment"><div class="line">examples/{component or module}/{optional sub-module or sub-component}/</div>
<div class="line">               |</div>
<div class="line">               + -- {example name}/{board on which this example can run}/</div>
<div class="line">                                     |</div>
<div class="line">                                     + -- {cpu}_{os}/{compiler toolchain}</div>
<div class="line">                                                        |</div>
<div class="line">                                                        + -- {example_name}.release.out</div>
<div class="line">                                                        + -- {example_name}.debug.out</div>
</div><!-- fragment --></li>
<li>Simply load and run binary .out on EVM using CCS (see <a class="el" href="CCS_LAUNCH_PAGE.html">CCS Launch, Load and Run</a>)</li>
<li>The same folder also has .map files which have more information about the binary size and memory section used, and so on.</li>
<li>In case of "system" examples, one need to load the binaries for each CPU one by one in CCS and then run each CPU. Typically the order of load and run of different CPUs is not important.</li>
</ul>
<h1><a class="anchor" id="autotoc_md153"></a>
Tips and Tricks when working with Makefiles</h1>
<ul>
<li>In general, the makefiles are written to be simple and use very basic GNU make syntax and options. You can simply open the makefile located within a example or library folder to see the different compile options, include paths, files, include directory, pre-processor defines etc that are used to build that example or library.</li>
<li>The only common file included by all makefiles is the top level <code>${SDK_INSTALL_PATH}/imports.mak</code>. This file defines paths to common tools like compiler, syscfg, CCS that are used by all examples. If you have installed the tools like CCS, SysConfig, Compiler at non-default paths, then modify the paths defined in this file.</li>
<li>When a specific example is built the libraries used by it are not checked for changes i.e. dependency is not set. So make sure to do a <code>gmake -s libs PROFILE={debug or release}</code> to build all libraries in case you have changed any library source or header file. This checks and triggers a "incremental" build across all libraries.</li>
<li>On Linux, you can pass <code>-j</code> option to allow make to use all CPUs on your host machine when running make. This will make the build time significantly faster depending on your host machine speed.</li>
<li>On Windows, the windows command prompt sometimes locks up when make is invoked with <code>-j</code> option. One solution is use a different shell in windows like the bash shell provided by GIT for windows, <a href="https://git-scm.com/download/win">https://git-scm.com/download/win</a> . With the bash shell for windows, you can pass <code>-j</code> to make the builds fast</li>
<li>You can pass <code>-s</code> to build in "silent" mode. This will suppress the actual command that is executed. So if you dont pass <code>-s</code> then the console will show the exact command that is executed by make. This can be useful in debugging error, if any.</li>
<li>You can pass <code>PROFILE=debug</code> or <code>PROFILE=release</code> as arguments to build in debug mode or release mode</li>
<li>You can also build a example by going to the example folder where the makefile is located and simply type one of below, <div class="fragment"><div class="line">cd ${SDK_INSTALL_PATH}/examples/kernel/dpl/hello_world/{board}/r5fss0-0_freertos/ti-arm-clang</div>
<div class="line">gmake -s all PROFILE={debug or release}   # Build the example</div>
<div class="line">gmake -s clean PROFILE={debug or release} # Clean the example</div>
<div class="line">gmake -s syscfg-gui                       # Launch SysConfig GUI for the example</div>
</div><!-- fragment --></li>
<li>In general, explore the commands and options listed under <code>gmake -s help</code> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.20 </li>
  </ul>
</div>
</body>
</html>
